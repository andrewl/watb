<html>
<head>
  <title>Nearest Docking Statons</title>
  <script src="js/jquery-1.4.2.min.js"></script>
  
  <script>
  function show_nearest_docking_stations(position) {
    
      jQuery.getJSON('/nearest.php/' + position.coords.longitude + '/' +  position.coords.latitude + '/10', function(json) {
        $('#json').html('<pre>' + json + '</pre>');
        mapurl = "http://maps.google.com/maps/api/staticmap?size=512x512&maptype=roadmap&sensor=false&";
        jQuery.each(json, function(idx, station) {
          $('div#stations').append('<p><strong>' + (idx+1) + " " + station.name + '</strong><br/>Available Bikes: ' + station.bikes + '<br/>Free Stands: ' + station.stands + '</p>');
          mapurl += "markers=color:blue|label:"+(idx+1)+"|"+station.latitude+","+station.longitude+"&";
        });
        $('#map').attr('src', mapurl);
      });
  }
  
  $(document).ready(function() {
      navigator.geolocation.getCurrentPosition(show_nearest_docking_stations);
  });
  
  </script>
  
</head>
<body>


<div>

<div style="float: left;" id="stations">  
</div>

<img id="map">

</div>

</body>
</html>